<!DOCTYPE html>
<html>
<head>
<title>Signup</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">
<div class="card p-4 mx-auto" style="max-width:420px;">
<h4 class="text-center">Signup</h4>

<form method="POST" onsubmit="return validatePasswords()">

<input class="form-control mb-3"
       name="username"
       placeholder="Username (5â€“9 chars)"
       required>

<!-- Password -->
<div class="input-group mb-2">
  <input class="form-control"
         type="password"
         id="password"
         name="password"
         placeholder="Password"
         onkeyup="checkStrength()"
         required>
  <span class="input-group-text" onclick="togglePassword('password','eye1')">
    <i id="eye1" class="bi bi-eye-slash"></i>
  </span>
</div>

<small id="strengthMsg"></small>

<!-- Confirm Password -->
<div class="input-group mt-3 mb-3">
  <input class="form-control"
         type="password"
         id="confirmPassword"
         placeholder="Confirm Password"
         required>
  <span class="input-group-text" onclick="togglePassword('confirmPassword','eye2')">
    <i id="eye2" class="bi bi-eye-slash"></i>
  </span>
</div>

<p id="errorMsg" class="text-danger"></p>

<button class="btn btn-success w-100">Signup</button>
</form>

{% if error %}
<p class="text-danger mt-2">{{ error }}</p>
{% endif %}

</div>
</div>

<script>
function togglePassword(inputId, iconId) {
  const input = document.getElementById(inputId);
  const icon = document.getElementById(iconId);

  if (input.type === "password") {
    input.type = "text";
    icon.className = "bi bi-eye";
  } else {
    input.type = "password";
    icon.className = "bi bi-eye-slash";
  }
}

function checkStrength() {
  const pwd = document.getElementById("password").value;
  const msg = document.getElementById("strengthMsg");

  if (pwd.length < 6) {
    msg.textContent = "Weak password";
    msg.className = "text-danger";
  } else if (/[A-Z]/.test(pwd) && /[0-9]/.test(pwd)) {
    msg.textContent = "Strong password";
    msg.className = "text-success";
  } else {
    msg.textContent = "Medium password";
    msg.className = "text-warning";
  }
}

function validatePasswords() {
  const p1 = document.getElementById("password").value;
  const p2 = document.getElementById("confirmPassword").value;

  if (p1 !== p2) {
    document.getElementById("errorMsg").textContent =
      "Passwords do not match";
    return false;
  }
  return true;
}
</script>

</body>
</html>
